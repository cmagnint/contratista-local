<!-- transferencias-realizadas.component.html -->

<div class="container">
    <h2 class="titulo">BUSCAR PAGOS REALIZADOS</h2>

    <!-- Sección de filtros -->
    <div class="filtros-fecha">
        <div class="form-group">
            <label for="fechaInicio">Fecha inicio:</label>
            <input id="fechaInicio" type="date" [(ngModel)]="fechaInicio">
        </div>
        <div class="form-group">
            <label for="fechaFin">Fecha fin:</label>
            <input id="fechaFin" type="date" [(ngModel)]="fechaFin">
        </div>
        <div class="form-group">
            <label for="tipoPago">Tipo de Pago:</label>
            <select id="tipoPago" [(ngModel)]="tipoPagoSeleccionado">
                <option value="todos">Todos</option>
                <option value="transferencia">Transferencias</option>
                <option value="efectivo">Efectivo</option>
            </select>
        </div>
        <button (click)="buscarPagos()" class="search-button">
            Buscar
        </button>
    </div>

    <!-- Tabla de pagos -->
    <div class="tabla-pagos" *ngIf="pagos.length > 0">
        <table>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Tipo</th>
                    <th>Sociedad</th>
                    <th>Cuenta Origen</th>
                    <th>Trabajador</th>
                    <th>RUT</th>
                    <th>Monto</th>
                    <th>Múltiplo</th>
                    <th>Saldo</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let pago of pagos">
                    <td>{{formatDate(pago.fecha_pago)}}</td>
                    <td>{{pago.tipo_pago}}</td>
                    <td>{{pago.sociedad.nombre}}</td>
                    <td>{{pago.cuenta_origen.banco_nombre}} - {{pago.cuenta_origen.numero_cuenta}}</td>
                    <td>{{pago.trabajador.nombres}}</td>
                    <td>{{pago.trabajador.rut}}</td>
                    <td>{{pago.monto_pagado | currency:'CLP':'symbol-narrow':'1.0-0'}}</td>
                    <td>{{pago.multiplo ? (pago.multiplo | currency:'CLP':'symbol-narrow':'1.0-0') : '-'}}</td>
                    <td [ngClass]="getSaldoClass(pago?.saldo)">
                        {{formatSaldo(pago?.saldo)}}
                    </td>
                </tr>
                <!-- Fila del total -->
                <tr class="total-row">
                    <td colspan="6" class="total-label">Total Pagado</td>
                    <td colspan="3" class="total-amount">{{totalPagos | currency:'CLP':'symbol-narrow':'1.0-0'}}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Mensaje cuando no hay datos -->
    <div class="no-data" *ngIf="pagos.length === 0">
        No se encontraron pagos en el período seleccionado
    </div>
</div>